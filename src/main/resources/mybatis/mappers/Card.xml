<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="card">
<!-- <select>, <insert>, <update>, <delete> -->
	<!-- 디비 넣기 -->
	<insert id="sendcard" parameterType="CardVo">
		<![CDATA[
			insert into card 
			values(seq_card_no.nextval,#{userNo},#{replyNo},#{cardImgNo},#{cardContent},sysdate,#{cardAge},#{cardGender})
		]]>
	
	</insert> 

	<insert id="receivecard" parameterType="CardVo">
		<![CDATA[
			insert into receiveCard 
			values(seq_receivecard_no.nextval,#{userNo},#{replyNo},#{cardImgNo},#{receiveContent},sysdate,#{cardAge},#{cardGender})
		]]>
	
	</insert> 
	
	<insert id="cardImg" parameterType="CardVo">
		<![CDATA[
			insert into cardImg
			values(seq_cardImg_no.nextval,#{cardImgName},#{cardImgSrc})
		]]>
	</insert>
	
	
	<!-- 사진 목록 가져오기 -->
	<select id="cardbg" resultType="CardVo"><!-- vo객체로 쿼리실행결과값 받을때 resultType -->
		<![CDATA[
			select  cardImgNo,
			        cardImgName,
			        cardImgSrc
			from cardImg
		]]>
	</select>
	
	<!-- 내가 쓴 카드 목록 가져오기 -->
	
	
	
	<!-- 답장 갯수 가져오기 -->
	<select id="reply" resultType="CardVo">
		<![CDATA[
			select  cd.cardNo cardNo,
		        	cd.userNo userNo,
		        	cd.replyNo replyNo,
		        	cd.cardImgNo cardImgNo,
		        	cd.cardContent cardContent,
		        	cd.cardRegdate cardRegdate,
		       		cd.cardAge cardAge,
		        	cd.cardGender cardGender,
		        	rc.replyContent replyContent
			from card cd, replyCard rc, (select count(replyNo) replyNo
		                             	from replyCard
		                             	group by cardNo) cntrn
			where cd.cardNo = rc.replyNo
			and cntrn.replyNo = cd.replyNo
		]]>
	</select>





</mapper>
